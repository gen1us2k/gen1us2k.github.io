<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="https://www.w3.org/2005/Atom">
  <channel>
    <title>Разработка on Andrew Minkin</title>
    <link>https://gen1us2k.com/tags/%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0/</link>
    <description>Recent content in Разработка on Andrew Minkin</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Gen1us2k</copyright>
    <lastBuildDate>Thu, 23 Jun 2016 23:47:43 +0600</lastBuildDate>
    <atom:link href="https://gen1us2k.com/tags/%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Самые частые ошибки и пути решения при росте нагрузки и масштабировании</title>
      <link>https://gen1us2k.com/2016/06/23/scaling1/</link>
      <pubDate>Thu, 23 Jun 2016 23:47:43 +0600</pubDate>
      
      <guid>https://gen1us2k.com/2016/06/23/scaling1/</guid>
      <description>

&lt;p&gt;Всем привет. Сегодня хотел бы рассказать о самых частых и детских болезней проектов.
Сначала мы делаем свой проект, допустим какой-нибудь веб сервис, мы в стадии стартапа или активной разработки. Приходит момент, когда мы запускаем проект, деплоим его на сервера, настраиваем окружение на нем. И в начале мы поднимаем все на одной виртуалке. Кто-то начинает задумываться о каких-то глазах на продакшне, кто-то нет.
Кто-то ставит себе newrelic, opbeat, или делает сбор эксепшнов либо через сентри, либо путем отправки на почту. Может быть кто-то пишет лог. Постепенно, пользователей становиться больше, соответсвенно и нагрузка растет. Давайте разберемся, что такое нагрузка и какая она бывает.&lt;/p&gt;

&lt;h3 id=&#34;что-такое-нагрузка:5bca2f17d7291f735910da9e1b034bfe&#34;&gt;Что такое нагрузка&lt;/h3&gt;

&lt;p&gt;Нагрузку генерят пользователи. Нагрузка бывает разная: на диск, на память, на процессор, на сетевой интерфейс. Обычно она растет плавно, иногда бывают всплески, из-за большого наплыва пользователей или DDoS атаки. Предже чем что-то делать, нужно проанализировать, на какой из компонентов у нас идет нагрузка. Есть множество утилит для просмотра состояния нагрузки на каждый из компонентов сервера:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;top/atop/htop/mpstat - для просмотра загрузки CPU&lt;/li&gt;
&lt;li&gt;free, cat /proc/meminfo/top/atop - для просмотра использования оперативной памяти&lt;/li&gt;
&lt;li&gt;Iostat/iotop для диска&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Какие частые симптомы бывают при нагрузке на диск:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Диск загружен, потому что с него очень часто и много читают. Эту нагрузку может генерить либо ваше приложение, либо БД. Либо у вас много статики. Суть одна. Уменьшить чтение можно, закешировав их в оперативной памяти и отдавать их с нее. Например увеличить innodb_buffer_pool_size установив значение, равной весу всех баз. Либо настроить кеширование статики в nginx, отдавая горячую статику с оперативной памяти&lt;/li&gt;
&lt;li&gt;Диск загружен, на запись. Ее может генерить база, может генерить приложение, если пользователи допустим много файлов аплодят, либо активно пишется лог. Решение - уменьшить запись. В случае с БД если это возможно, то писать в базу большой порцией данных за меньшее время. Можно отключить логгиирование или дебаг, если он включен&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;В случае с ОЗУ - либо это последствия того, что мы скинули все в память, снижая нагрузку на диск. Либо у нас приложение течет.
В случае нагрузки на CPU - это вычисления и ожидание io. Сетевого или дискового&lt;/p&gt;

&lt;p&gt;Все эти проблемы нужно решать. При этом на сервере у вас происходит борьба за ресурсы между кучей бекендов, которые у вас установлены&lt;/p&gt;

&lt;p&gt;По нагрузке и вводной части все. Подробнее о путях решения расскажу в следующем посте&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>